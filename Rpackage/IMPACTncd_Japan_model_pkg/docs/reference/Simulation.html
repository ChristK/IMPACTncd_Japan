<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>R6 Class representing a simulation environment — Simulation • IMPACTncdJapan</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="R6 Class representing a simulation environment — Simulation"><meta name="description" content="A simulation environment."><meta property="og:description" content="A simulation environment."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">IMPACTncdJapan</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><a class="dropdown-item" href="../articles/quickstart.html">Quick Start Guide</a></li>
    <li><a class="dropdown-item" href="../articles/installation.html">Installation Guide</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>User Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/running-simulations.html">Running Simulations</a></li>
    <li><a class="dropdown-item" href="../articles/scenario-analysis.html">Scenario Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/docker-setup.html">Docker Setup</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Technical Documentation</h6></li>
    <li><a class="dropdown-item" href="../articles/model-architecture.html">Model Architecture</a></li>
    <li><a class="dropdown-item" href="../articles/technical-appendix.html">Technical Appendix</a></li>
    <li><a class="dropdown-item" href="../articles/extending-model.html">Extending the Model</a></li>
    <li><a class="dropdown-item" href="../articles/troubleshooting.html">Troubleshooting</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Publications</h6></li>
    <li><a class="dropdown-item" href="../articles/publications.html">Scientific Publications</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Tutorials</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ChristK/IMPACTncd_Japan" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>R6 Class representing a simulation environment</h1>
      <small class="dont-index">Source: <a href="https://github.com/ChristK/IMPACTncd_Japan/blob/HEAD/R/Simulation_class.R" class="external-link"><code>R/Simulation_class.R</code></a></small>
      <div class="d-none name"><code>Simulation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A simulation environment.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>To be completed...</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The calibration parameters are stored in `./simulation/calibration_prms.csv`
  and are automatically applied in subsequent simulations.</p>
    </div>
    <div class="section level2">
    <h2 id="calibration-process">Calibration Process<a class="anchor" aria-label="anchor" href="#calibration-process"></a></h2>



<p>The calibration operates over a specific time period defined by two key parameters:</p><ul><li><p>**Start year**: The initial year for in the designated sim_design yaml file</p></li>
<li><p>**End year**: The latest year as defined by the sim_horizon in sim_design yaml file</p></li>
</ul><p>The calibration process follows these steps for each age from `ageL` to `ageH`:</p>
<div class="section">
<h3 id="-incidence-calibration">1. Incidence Calibration<a class="anchor" aria-label="anchor" href="#-incidence-calibration"></a></h3>
<p>For both CHD and stroke:</p><ul><li><p>Runs simulation and extracts uncalibrated incidence rates</p></li>
<li><p>Fits log-log linear models to both benchmark and simulated data over the calibration period</p></li>
<li><p>Calculates calibration factors to align simulated trends with benchmark trends</p></li>
<li><p>Updates prevalence estimates based on incidence corrections</p></li>
</ul></div>

<div class="section">
<h3 id="-case-fatality-calibration">2. Case Fatality Calibration<a class="anchor" aria-label="anchor" href="#-case-fatality-calibration"></a></h3>
<p>For CHD, stroke, and non-modeled causes:</p><ul><li><p>Incorporates incidence-corrected prevalence estimates</p></li>
<li><p>Calculates calibration factors for case fatality rates</p></li>
<li><p>Ensures mortality rates align with benchmark data</p></li>
<li><p>Applies competing risk adjustments for previous ages</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="implementation-details">Implementation Details<a class="anchor" aria-label="anchor" href="#implementation-details"></a></h2>



<ul><li><p>**Sequential Processing**: Ages are processed sequentially to ensure proper
    prevalence carryover between age groups</p></li>
<li><p>**Trend Modeling**: Uses log-log linear regression to capture temporal trends
    in the calibration period</p></li>
<li><p>**Robust Estimation**: Employs median-based estimators to handle
    rare events and reduce Monte Carlo variability</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a></h2>
    <p></p><div class="r6-fields"><dl><dt><code>design</code></dt>
<dd><p>A Design object.</p></dd>


<dt><code>diseases</code></dt>
<dd><p>A list of Disease objects.</p></dd>


<dt><code>RR</code></dt>
<dd><p>A list of RR for the simulated exposures.</p></dd>


<dt><code>scenarios</code></dt>
<dd><p>A list of scenario objects.</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-Simulation-new"><code>Simulation$new()</code></a></p></li>
<li><p><a href="#method-Simulation-update_primary_prevention_scn"><code>Simulation$update_primary_prevention_scn()</code></a></p></li>
<li><p><a href="#method-Simulation-get_primary_prevention_scn"><code>Simulation$get_primary_prevention_scn()</code></a></p></li>
<li><p><a href="#method-Simulation-update_secondary_prevention_scn"><code>Simulation$update_secondary_prevention_scn()</code></a></p></li>
<li><p><a href="#method-Simulation-get_secondary_prevention_scn"><code>Simulation$get_secondary_prevention_scn()</code></a></p></li>
<li><p><a href="#method-Simulation-run"><code>Simulation$run()</code></a></p></li>
<li><p><a href="#method-Simulation-calibrate_incd_ftlt"><code>Simulation$calibrate_incd_ftlt()</code></a></p></li>
<li><p><a href="#method-Simulation-export_summaries"><code>Simulation$export_summaries()</code></a></p></li>
<li><p><a href="#method-Simulation-export_tables"><code>Simulation$export_tables()</code></a></p></li>
<li><p><a href="#method-Simulation-get_causal_structure"><code>Simulation$get_causal_structure()</code></a></p></li>
<li><p><a href="#method-Simulation-get_node_names"><code>Simulation$get_node_names()</code></a></p></li>
<li><p><a href="#method-Simulation-get_causal_path"><code>Simulation$get_causal_path()</code></a></p></li>
<li><p><a href="#method-Simulation-update_design"><code>Simulation$update_design()</code></a></p></li>
<li><p><a href="#method-Simulation-del_outputs"><code>Simulation$del_outputs()</code></a></p></li>
<li><p><a href="#method-Simulation-del_summaries"><code>Simulation$del_summaries()</code></a></p></li>
<li><p><a href="#method-Simulation-del_logs"><code>Simulation$del_logs()</code></a></p></li>
<li><p><a href="#method-Simulation-del_parfs"><code>Simulation$del_parfs()</code></a></p></li>
<li><p><a href="#method-Simulation-del_RR_cache"><code>Simulation$del_RR_cache()</code></a></p></li>
<li><p><a href="#method-Simulation-del_synthpops"><code>Simulation$del_synthpops()</code></a></p></li>
<li><p><a href="#method-Simulation-get_esp"><code>Simulation$get_esp()</code></a></p></li>
<li><p><a href="#method-Simulation-get_mm_weights"><code>Simulation$get_mm_weights()</code></a></p></li>
<li><p><a href="#method-Simulation-validate"><code>Simulation$validate()</code></a></p></li>
<li><p><a href="#method-Simulation-split_large_files"><code>Simulation$split_large_files()</code></a></p></li>
<li><p><a href="#method-Simulation-reconstruct_large_files"><code>Simulation$reconstruct_large_files()</code></a></p></li>
<li><p><a href="#method-Simulation-del_large_files"><code>Simulation$del_large_files()</code></a></p></li>
<li><p><a href="#method-Simulation-print"><code>Simulation$print()</code></a></p></li>
<li><p><a href="#method-Simulation-clone"><code>Simulation$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-Simulation-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Create a new simulation object.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/Simulation.html">Simulation</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">sim_prm</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>sim_prm</code></dt>
<dd><p>Either a path to a yaml file or a Design object.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>A new `Simulation` object.</p>
</div>

</div><p></p><hr><a id="method-Simulation-update_primary_prevention_scn"></a><div class="section">
<h3 id="method-update-primary-prevention-scn-">Method <code>update_primary_prevention_scn()</code><a class="anchor" aria-label="anchor" href="#method-update-primary-prevention-scn-"></a></h3>
<p>Updates the primary prevention policy scenario</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">update_primary_prevention_scn</span><span class="op">(</span><span class="va">method</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>method</code></dt>
<dd><p>a function with synthpop as an argument that models the primary prevention policy.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>The invisible self for chaining.</p>
</div>

</div><p></p><hr><a id="method-Simulation-get_primary_prevention_scn"></a><div class="section">
<h3 id="method-get-primary-prevention-scn-">Method <code>get_primary_prevention_scn()</code><a class="anchor" aria-label="anchor" href="#method-get-primary-prevention-scn-"></a></h3>
<p>Get the primary prevention policy scenario</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">get_primary_prevention_scn</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p>The primary prevention policy scenario.</p>
</div>

</div><p></p><hr><a id="method-Simulation-update_secondary_prevention_scn"></a><div class="section">
<h3 id="method-update-secondary-prevention-scn-">Method <code>update_secondary_prevention_scn()</code><a class="anchor" aria-label="anchor" href="#method-update-secondary-prevention-scn-"></a></h3>
<p>Updates the secondary prevention policy scenario</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">update_secondary_prevention_scn</span><span class="op">(</span><span class="va">method</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>method</code></dt>
<dd><p>a function with synthpop as an argument that models the secondary prevention policy.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a></h4>
<p>The invisible self for chaining.</p>
</div>

</div><p></p><hr><a id="method-Simulation-get_secondary_prevention_scn"></a><div class="section">
<h3 id="method-get-secondary-prevention-scn-">Method <code>get_secondary_prevention_scn()</code><a class="anchor" aria-label="anchor" href="#method-get-secondary-prevention-scn-"></a></h3>
<p>Get the secondary prevention policy scenario</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">get_secondary_prevention_scn</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-4">Returns<a class="anchor" aria-label="anchor" href="#returns-4"></a></h4>
<p>The secondary prevention policy scenario.</p>
</div>

</div><p></p><hr><a id="method-Simulation-run"></a><div class="section">
<h3 id="method-run-">Method <code>run()</code><a class="anchor" aria-label="anchor" href="#method-run-"></a></h3>
<p>Runs a simulation</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="va">mc</span>, multicore <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">scenario_nam</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>mc</code></dt>
<dd><p>A positive sequential integer vector with the Monte Carlo
iterations of synthetic population to simulate, or a scalar.</p></dd>


<dt><code>multicore</code></dt>
<dd><p>If TRUE run the simulation in parallel.</p></dd>


<dt><code>scenario_nam</code></dt>
<dd><p>A string for the scenario name (i.e. sc1)</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-5">Returns<a class="anchor" aria-label="anchor" href="#returns-5"></a></h4>
<p>The invisible self for chaining.</p>
</div>

</div><p></p><hr><a id="method-Simulation-calibrate_incd_ftlt"></a><div class="section">
<h3 id="method-calibrate-incd-ftlt-">Method <code>calibrate_incd_ftlt()</code><a class="anchor" aria-label="anchor" href="#method-calibrate-incd-ftlt-"></a></h3>
<p>Generates new calibration parameters for incidence and case fatality rates.</p>
<p>This method implements a sequential age-based calibration process that aligns
modeled disease incidence and case fatality rates with user input data from
external sources (e.g., GBD, national statistics). The calibration ensures
that simulation outputs match observed epidemiological patterns.</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">calibrate_incd_ftlt</span><span class="op">(</span><span class="va">mc</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>mc</code></dt>
<dd><p>A positive sequential integer vector with the Monte Carlo
iterations of synthetic population to simulate, or a scalar.</p></dd>


<dt><code>replace</code></dt>
<dd><p>If TRUE the calibration deletes the previous calibration file and
starts from scratch. If FALSE, continues from the last uncalibrated age.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-6">Returns<a class="anchor" aria-label="anchor" href="#returns-6"></a></h4>
<p>The invisible self for chaining.</p>
</div>

</div><p></p><hr><a id="method-Simulation-export_summaries"></a><div class="section">
<h3 id="method-export-summaries-">Method <code>export_summaries()</code><a class="anchor" aria-label="anchor" href="#method-export-summaries-"></a></h3>
<p>Process the lifecourse files</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">export_summaries</span><span class="op">(</span></span>
<span>  multicore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"le"</span>, <span class="st">"hle"</span>, <span class="st">"dis_char"</span>, <span class="st">"prvl"</span>, <span class="st">"incd"</span>, <span class="st">"dis_mrtl"</span>, <span class="st">"mrtl"</span>,</span>
<span>    <span class="st">"all_cause_mrtl_by_dis"</span>, <span class="st">"cms"</span>, <span class="st">"qalys"</span>, <span class="st">"costs"</span><span class="op">)</span>,</span>
<span>  single_year_of_age <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>multicore</code></dt>
<dd><p>If TRUE run the simulation in parallel.</p></dd>


<dt><code>type</code></dt>
<dd><p>The type of summary to extract.</p></dd>


<dt><code>single_year_of_age</code></dt>
<dd><p>Export summaries by single year of age. Useful for the calibration proccess.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-7">Returns<a class="anchor" aria-label="anchor" href="#returns-7"></a></h4>
<p>The invisible self for chaining.</p>
</div>

</div><p></p><hr><a id="method-Simulation-export_tables"></a><div class="section">
<h3 id="method-export-tables-">Method <code>export_tables()</code><a class="anchor" aria-label="anchor" href="#method-export-tables-"></a></h3>
<p>Export summary tables for the simulation results.</p>
<p>This method generates and exports summary tables for the main simulation outputs,
including prevalence, incidence, mortality, disease characteristics, and exposures.
It calls modular helper methods for each type of summary, ensuring output directories
are created as needed and that all tables are written to the appropriate locations.</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">export_tables</span><span class="op">(</span></span>
<span>  baseline_year_for_change_outputs <span class="op">=</span> <span class="fl">2019L</span>,</span>
<span>  prbl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.025</span>, <span class="fl">0.975</span>, <span class="fl">0.1</span>, <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>baseline_year_for_change_outputs</code></dt>
<dd><p>Integer. The baseline year to use for change outputs (default: 2019L).</p></dd>


<dt><code>prbl</code></dt>
<dd><p>Numeric vector. The quantiles to use for summary statistics (default: c(0.5, 0.025, 0.975, 0.1, 0.9)).</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details-1">Details<a class="anchor" aria-label="anchor" href="#details-1"></a></h4>
<p>This method is a high-level wrapper that orchestrates the export of all main summary tables.
It delegates the actual export logic to the following private helper methods:
- <code>private$export_main_tables</code>
- <code>private$export_all_cause_mrtl_tables</code>
- <code>private$export_disease_characteristics_tables</code>
- <code>private$export_xps_tables</code></p>
<p>Each helper method is responsible for a specific set of outputs and ensures that
the results are saved in the correct format and location.</p>
</div>

<div class="section">
<h4 id="returns-8">Returns<a class="anchor" aria-label="anchor" href="#returns-8"></a></h4>
<p>The invisible self for chaining.</p>
</div>
<div class="section">
<h4 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="va">IMPACTncd</span><span class="op">$</span><span class="fu">export_tables</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Simulation-get_causal_structure"></a><div class="section">
<h3 id="method-get-causal-structure-">Method <code>get_causal_structure()</code><a class="anchor" aria-label="anchor" href="#method-get-causal-structure-"></a></h3>
<p>Returns the causality matrix and optionally plots the
  causality structure.</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">get_causal_structure</span><span class="op">(</span></span>
<span>  processed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  print_plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  focus <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-7">Arguments<a class="anchor" aria-label="anchor" href="#arguments-7"></a></h4>
<p></p><div class="arguments"><dl><dt><code>processed</code></dt>
<dd><p>If `TRUE` generates the causality matrix from the
graph.</p></dd>


<dt><code>print_plot</code></dt>
<dd><p>If `TRUE` prints the causal structure graph.</p></dd>


<dt><code>focus</code></dt>
<dd><p>If missing the whole causal structure is returned.
Otherwise, if a named node only the subgraph of the 1st order
neighbours that point to the given vertrice is returned.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-9">Returns<a class="anchor" aria-label="anchor" href="#returns-9"></a></h4>
<p>The processed causality matrix if `processed = TRUE` or the
  graph otherwise.</p>
</div>

</div><p></p><hr><a id="method-Simulation-get_node_names"></a><div class="section">
<h3 id="method-get-node-names-">Method <code>get_node_names()</code><a class="anchor" aria-label="anchor" href="#method-get-node-names-"></a></h3>
<p>Returns the names of all exposures and diseases.</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">get_node_names</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-10">Returns<a class="anchor" aria-label="anchor" href="#returns-10"></a></h4>
<p>A string vector.</p>
</div>

</div><p></p><hr><a id="method-Simulation-get_causal_path"></a><div class="section">
<h3 id="method-get-causal-path-">Method <code>get_causal_path()</code><a class="anchor" aria-label="anchor" href="#method-get-causal-path-"></a></h3>
<p>Returns the causal paths between an exposure and an outcome (disease).</p><div class="section">
<h4 id="usage-11">Usage<a class="anchor" aria-label="anchor" href="#usage-11"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">get_causal_path</span><span class="op">(</span><span class="va">from</span>, <span class="va">to</span>, shortest_paths <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-8">Arguments<a class="anchor" aria-label="anchor" href="#arguments-8"></a></h4>
<p></p><div class="arguments"><dl><dt><code>from</code></dt>
<dd><p>the beginning of the path (an exposure) as a string. Use `get_node_names` for available nodes.</p></dd>


<dt><code>to</code></dt>
<dd><p>the end of the path (a disease) as a string. Use `get_node_names` for available nodes.</p></dd>


<dt><code>shortest_paths</code></dt>
<dd><p>Boolean. If true, only returns the paths with the smallest number of nodes. Else, all possible paths (excluding multiple and loop edges) are returned.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-11">Returns<a class="anchor" aria-label="anchor" href="#returns-11"></a></h4>
<p>A list with all the possible paths between exposure and disease.</p>
</div>

</div><p></p><hr><a id="method-Simulation-update_design"></a><div class="section">
<h3 id="method-update-design-">Method <code>update_design()</code><a class="anchor" aria-label="anchor" href="#method-update-design-"></a></h3>
<p>Updates the Design object that is stored in the Simulation
  object.</p><div class="section">
<h4 id="usage-12">Usage<a class="anchor" aria-label="anchor" href="#usage-12"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">update_design</span><span class="op">(</span><span class="va">new_design</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-9">Arguments<a class="anchor" aria-label="anchor" href="#arguments-9"></a></h4>
<p></p><div class="arguments"><dl><dt><code>new_design</code></dt>
<dd><p>A design object with the simulation parameters.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-12">Returns<a class="anchor" aria-label="anchor" href="#returns-12"></a></h4>
<p>The invisible self for chaining.</p>
</div>

</div><p></p><hr><a id="method-Simulation-del_outputs"></a><div class="section">
<h3 id="method-del-outputs-">Method <code>del_outputs()</code><a class="anchor" aria-label="anchor" href="#method-del-outputs-"></a></h3>
<p>Delete all output files and folders below the first level.</p><div class="section">
<h4 id="usage-13">Usage<a class="anchor" aria-label="anchor" href="#usage-13"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">del_outputs</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-13">Returns<a class="anchor" aria-label="anchor" href="#returns-13"></a></h4>
<p>The invisible self for chaining.</p>
</div>

</div><p></p><hr><a id="method-Simulation-del_summaries"></a><div class="section">
<h3 id="method-del-summaries-">Method <code>del_summaries()</code><a class="anchor" aria-label="anchor" href="#method-del-summaries-"></a></h3>
<p>Delete all output summary files and subdirectories while preserving first-level directory structure.</p><div class="section">
<h4 id="usage-14">Usage<a class="anchor" aria-label="anchor" href="#usage-14"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">del_summaries</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-14">Returns<a class="anchor" aria-label="anchor" href="#returns-14"></a></h4>
<p>The invisible self for chaining.</p>
</div>

</div><p></p><hr><a id="method-Simulation-del_logs"></a><div class="section">
<h3 id="method-del-logs-">Method <code>del_logs()</code><a class="anchor" aria-label="anchor" href="#method-del-logs-"></a></h3>
<p>Delete log files.</p><div class="section">
<h4 id="usage-15">Usage<a class="anchor" aria-label="anchor" href="#usage-15"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">del_logs</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-15">Returns<a class="anchor" aria-label="anchor" href="#returns-15"></a></h4>
<p>The invisible self for chaining.</p>
</div>

</div><p></p><hr><a id="method-Simulation-del_parfs"></a><div class="section">
<h3 id="method-del-parfs-">Method <code>del_parfs()</code><a class="anchor" aria-label="anchor" href="#method-del-parfs-"></a></h3>
<p>Delete all files in the ./simulation/parf folder.</p><div class="section">
<h4 id="usage-16">Usage<a class="anchor" aria-label="anchor" href="#usage-16"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">del_parfs</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-16">Returns<a class="anchor" aria-label="anchor" href="#returns-16"></a></h4>
<p>The invisible self for chaining.</p>
</div>

</div><p></p><hr><a id="method-Simulation-del_RR_cache"></a><div class="section">
<h3 id="method-del-rr-cache-">Method <code>del_RR_cache()</code><a class="anchor" aria-label="anchor" href="#method-del-rr-cache-"></a></h3>
<p>Delete all files in the ./simulation/rr folder.</p><div class="section">
<h4 id="usage-17">Usage<a class="anchor" aria-label="anchor" href="#usage-17"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">del_RR_cache</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-17">Returns<a class="anchor" aria-label="anchor" href="#returns-17"></a></h4>
<p>The invisible self for chaining.</p>
</div>

</div><p></p><hr><a id="method-Simulation-del_synthpops"></a><div class="section">
<h3 id="method-del-synthpops-">Method <code>del_synthpops()</code><a class="anchor" aria-label="anchor" href="#method-del-synthpops-"></a></h3>
<p>Delete all files in the synthpop folder.</p><div class="section">
<h4 id="usage-18">Usage<a class="anchor" aria-label="anchor" href="#usage-18"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">del_synthpops</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-18">Returns<a class="anchor" aria-label="anchor" href="#returns-18"></a></h4>
<p>The invisible self for chaining.</p>
</div>

</div><p></p><hr><a id="method-Simulation-get_esp"></a><div class="section">
<h3 id="method-get-esp-">Method <code>get_esp()</code><a class="anchor" aria-label="anchor" href="#method-get-esp-"></a></h3>
<p>Get the European Standardised Population 2013 by sex and
  dimd.</p><div class="section">
<h4 id="usage-19">Usage<a class="anchor" aria-label="anchor" href="#usage-19"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">get_esp</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-19">Returns<a class="anchor" aria-label="anchor" href="#returns-19"></a></h4>
<p>A data.table with the European Standardised Population 2013.</p>
</div>

</div><p></p><hr><a id="method-Simulation-get_mm_weights"></a><div class="section">
<h3 id="method-get-mm-weights-">Method <code>get_mm_weights()</code><a class="anchor" aria-label="anchor" href="#method-get-mm-weights-"></a></h3>
<p>Get the disease multimorbidity weights (i.e. Cambridge
  Morbidity Score weights).</p><div class="section">
<h4 id="usage-20">Usage<a class="anchor" aria-label="anchor" href="#usage-20"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">get_mm_weights</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-20">Returns<a class="anchor" aria-label="anchor" href="#returns-20"></a></h4>
<p>A named vector with disease weights.</p>
</div>

</div><p></p><hr><a id="method-Simulation-validate"></a><div class="section">
<h3 id="method-validate-">Method <code>validate()</code><a class="anchor" aria-label="anchor" href="#method-validate-"></a></h3>
<p>Internal validation of the disease burden.</p><div class="section">
<h4 id="usage-21">Usage<a class="anchor" aria-label="anchor" href="#usage-21"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">validate</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-21">Returns<a class="anchor" aria-label="anchor" href="#returns-21"></a></h4>
<p>The invisible self for chaining.</p>
</div>

</div><p></p><hr><a id="method-Simulation-split_large_files"></a><div class="section">
<h3 id="method-split-large-files-">Method <code>split_large_files()</code><a class="anchor" aria-label="anchor" href="#method-split-large-files-"></a></h3>
<p>Splits files larger than 50Mb into chunks of 49Mb.</p><div class="section">
<h4 id="usage-22">Usage<a class="anchor" aria-label="anchor" href="#usage-22"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">split_large_files</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="details-2">Details<a class="anchor" aria-label="anchor" href="#details-2"></a></h4>
<p>The function splits files larger than 50Mb into chunks of 49Mb
so they can be tracked by GitHub. The large files are deleted and an
index is created at "./simulation/large_files_indx.csv" so they can be
reconstructed. The function also adds the large files to `.gitignore`.
It works on Linux and Windows. Untested on Mac.</p>
</div>

<div class="section">
<h4 id="returns-22">Returns<a class="anchor" aria-label="anchor" href="#returns-22"></a></h4>
<p>The invisible `Simulation` object.</p>
</div>

</div><p></p><hr><a id="method-Simulation-reconstruct_large_files"></a><div class="section">
<h3 id="method-reconstruct-large-files-">Method <code>reconstruct_large_files()</code><a class="anchor" aria-label="anchor" href="#method-reconstruct-large-files-"></a></h3>
<p>Reconstructs large files from chunks.</p><div class="section">
<h4 id="usage-23">Usage<a class="anchor" aria-label="anchor" href="#usage-23"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">reconstruct_large_files</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="details-3">Details<a class="anchor" aria-label="anchor" href="#details-3"></a></h4>
<p>The function reconstructs large files from chunks. The path of
the files are stored in "./simulation/large_files_indx.csv". It works
on Linux and Windows. Untested on Mac.</p>
</div>

<div class="section">
<h4 id="returns-23">Returns<a class="anchor" aria-label="anchor" href="#returns-23"></a></h4>
<p>The invisible `Simulation` object.</p>
</div>

</div><p></p><hr><a id="method-Simulation-del_large_files"></a><div class="section">
<h3 id="method-del-large-files-">Method <code>del_large_files()</code><a class="anchor" aria-label="anchor" href="#method-del-large-files-"></a></h3>
<p>Deletes large files.</p><div class="section">
<h4 id="usage-24">Usage<a class="anchor" aria-label="anchor" href="#usage-24"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">del_large_files</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="details-4">Details<a class="anchor" aria-label="anchor" href="#details-4"></a></h4>
<p>The function deletes large files that are stored in chunks.
The path of the files are stored in
"./simulation/large_files_indx.csv".</p>
</div>

<div class="section">
<h4 id="returns-24">Returns<a class="anchor" aria-label="anchor" href="#returns-24"></a></h4>
<p>The invisible `Simulation` object.</p>
</div>

</div><p></p><hr><a id="method-Simulation-print"></a><div class="section">
<h3 id="method-print-">Method <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code><a class="anchor" aria-label="anchor" href="#method-print-"></a></h3>
<p>Prints the simulation object metadata.</p><div class="section">
<h4 id="usage-25">Usage<a class="anchor" aria-label="anchor" href="#usage-25"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-25">Returns<a class="anchor" aria-label="anchor" href="#returns-25"></a></h4>
<p>The invisible `Simulation` object.</p>
</div>

</div><p></p><hr><a id="method-Simulation-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-26">Usage<a class="anchor" aria-label="anchor" href="#usage-26"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Simulation</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-10">Arguments<a class="anchor" aria-label="anchor" href="#arguments-10"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `Simulation$export_tables`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">IMPACTncd</span><span class="op">$</span><span class="fu">export_tables</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'IMPACTncd' not found</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Chris Kypridemos and contributors at University of Liverpool Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

<div class="pkgdown-footer-right">
  <p>list(icon = “fab fa-github fa-lg”, href = “<a href="https://github.com/ChristK/IMPACTncd_Japan" class="external-link uri">https://github.com/ChristK/IMPACTncd_Japan</a>”, <code>aria-label</code> = “GitHub”) Licensed under GPL-3</p>
</div>

    </footer></div>





  </body></html>


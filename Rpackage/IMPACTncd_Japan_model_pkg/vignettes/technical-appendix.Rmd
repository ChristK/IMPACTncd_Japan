---
title: "Technical Appendix"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Technical Appendix}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  eval = FALSE
)
```

# Technical Appendix: IMPACTncd-Japan Model

This technical appendix provides comprehensive documentation of the IMPACTncd-Japan model methodology, implementation details, and mathematical formulations.

*Note: This content is derived from the technical appendix published with the main model paper (Kypridemos et al., 2025, DOI: 10.1016/j.lanwpc.2025.101623).*

## 1. Model Overview

### 1.1 Model Structure

The IMPACTncd-Japan model is a closed-cohort microsimulation model that simulates the lifecourse of a synthetic population of Japanese adults. The model tracks individuals from age 20 to death, modeling:

- **Risk factor trajectories**: Smoking, BMI, blood pressure, cholesterol, physical activity
- **Disease incidence**: CHD, stroke, diabetes, COPD, lung cancer
- **Disease progression**: Including complications and case fatality
- **Mortality**: Disease-specific and all-cause mortality

### 1.2 Conceptual Framework

*[This section would include details from the PDF about the conceptual framework, model flow diagrams, etc.]*

### 1.3 Model Population

*[Details about the synthetic population generation, demographics, etc.]*

## 2. Risk Factor Modeling

### 2.1 Smoking

#### 2.1.1 Smoking Initiation
*[Mathematical formulations for smoking initiation rates]*

```{r smoking-initiation, eval=FALSE}
# Example structure for smoking initiation model
# logit(P_initiation) = β₀ + β₁×age + β₂×sex + β₃×education + ...
```

#### 2.1.2 Smoking Cessation
*[Mathematical formulations for smoking cessation rates]*

#### 2.1.3 Smoking Intensity
*[Modeling of cigarettes per day among smokers]*

### 2.2 Body Mass Index (BMI)

#### 2.2.1 BMI Trajectories
*[Mathematical formulations for BMI change over time]*

#### 2.2.2 Obesity Transitions
*[Modeling transitions between BMI categories]*

### 2.3 Blood Pressure

#### 2.3.1 Systolic Blood Pressure Model
*[Continuous modeling of systolic blood pressure]*

#### 2.3.2 Hypertension Incidence
*[Binary modeling of hypertension diagnosis]*

### 2.4 Cholesterol

#### 2.4.1 Total Cholesterol Model
*[Continuous modeling of total cholesterol]*

#### 2.4.2 Treatment Effects
*[Modeling of statin and other lipid-lowering treatments]*

### 2.5 Physical Activity

#### 2.5.1 Physical Activity Levels
*[Modeling of physical activity patterns]*

#### 2.5.2 Sedentary Behavior
*[Modeling of sedentary time]*

## 3. Disease Models

### 3.1 Coronary Heart Disease (CHD)

#### 3.1.1 Incidence Model
*[Mathematical formulation for CHD incidence]*

```{r chd-incidence, eval=FALSE}
# Example CHD incidence model structure
# log(hazard_CHD) = β₀ + β₁×age + β₂×sex + β₃×smoking + β₄×SBP + β₅×cholesterol + ...
```

#### 3.1.2 Case Fatality
*[CHD case fatality rates and time trends]*

#### 3.1.3 Recurrent Events
*[Modeling of recurrent CHD events]*

### 3.2 Stroke

#### 3.2.1 Stroke Incidence
*[Mathematical formulation for stroke incidence]*

#### 3.2.2 Stroke Subtypes
*[Ischemic vs hemorrhagic stroke modeling]*

#### 3.2.3 Stroke Survival
*[Post-stroke survival modeling]*

### 3.3 Diabetes

#### 3.3.1 Type 2 Diabetes Incidence
*[Mathematical formulation for diabetes incidence]*

#### 3.3.2 Diabetes Complications
*[Modeling of diabetic complications]*

#### 3.3.3 Diabetes Management
*[Treatment effects and control modeling]*

### 3.4 Chronic Obstructive Pulmonary Disease (COPD)

#### 3.4.1 COPD Incidence
*[Mathematical formulation for COPD incidence]*

#### 3.4.2 COPD Progression
*[Disease severity progression modeling]*

### 3.5 Lung Cancer

#### 3.5.1 Lung Cancer Incidence
*[Mathematical formulation for lung cancer incidence]*

#### 3.5.2 Lung Cancer Survival
*[Survival modeling by stage and treatment]*

## 4. Mortality Modeling

### 4.1 Background Mortality

#### 4.1.1 All-Cause Mortality
*[Background mortality rates by age and sex]*

#### 4.1.2 Competing Risks
*[Handling of competing risks in the simulation]*

### 4.2 Disease-Specific Mortality

#### 4.2.1 Relative Risk Models
*[Disease-specific mortality relative risks]*

#### 4.2.2 Temporal Trends
*[Time trends in case fatality rates]*

## 5. Data Sources and Calibration

### 5.1 Input Data Sources

#### 5.1.1 Population Demographics
*[Details of population data sources]*

#### 5.1.2 Risk Factor Distributions
*[Sources for risk factor prevalence and trends]*

#### 5.1.3 Disease Incidence Data
*[Sources for disease incidence rates]*

#### 5.1.4 Mortality Data
*[Sources for mortality statistics]*

### 5.2 Calibration Methods

#### 5.2.1 Calibration Targets
*[Description of calibration targets and methods]*

#### 5.2.2 Calibration Algorithms
*[Mathematical description of calibration procedures]*

#### 5.2.3 Validation Metrics
*[Metrics used to assess model performance]*

## 6. Model Implementation

### 6.1 Software Architecture

#### 6.1.1 R Package Structure
*[Description of R package organization]*

#### 6.1.2 C++ Implementation
*[Details of C++ components for performance]*

#### 6.1.3 Parallel Processing
*[Implementation of parallel simulation]*

### 6.2 Simulation Algorithm

#### 6.2.1 Main Simulation Loop
*[Pseudocode for main simulation algorithm]*

```{r simulation-algorithm, eval=FALSE}
# Pseudocode for main simulation loop
for (year in simulation_years) {
  for (individual in population) {
    # Update age
    individual$age <- individual$age + 1
    
    # Update risk factors
    individual <- update_risk_factors(individual)
    
    # Check for disease incidence
    individual <- check_disease_incidence(individual)
    
    # Update disease progression
    individual <- update_disease_states(individual)
    
    # Check for mortality
    individual <- check_mortality(individual)
  }
  
  # Export annual results
  export_annual_results(year)
}
```

#### 6.2.2 Random Number Generation
*[Details of random number generation and reproducibility]*

#### 6.2.3 Memory Management
*[Strategies for efficient memory usage]*

### 6.3 Output Generation

#### 6.3.1 Summary Statistics
*[Methods for generating summary outputs]*

#### 6.3.2 Confidence Intervals
*[Calculation of uncertainty bounds]*

#### 6.3.3 Export Formats
*[Description of output file formats]*

## 7. Model Parameters

### 7.1 Risk Factor Parameters

#### 7.1.1 Smoking Parameters
*[Complete list of smoking-related parameters]*

#### 7.1.2 BMI Parameters
*[Complete list of BMI-related parameters]*

#### 7.1.3 Blood Pressure Parameters
*[Complete list of blood pressure parameters]*

### 7.2 Disease Parameters

#### 7.2.1 CHD Parameters
*[Complete list of CHD model parameters]*

#### 7.2.2 Stroke Parameters
*[Complete list of stroke model parameters]*

#### 7.2.3 Diabetes Parameters
*[Complete list of diabetes model parameters]*

### 7.3 Mortality Parameters

#### 7.3.1 Background Mortality Tables
*[Life tables and mortality parameters]*

#### 7.3.2 Relative Risk Parameters
*[Disease-specific relative risk parameters]*

## 8. Validation and Sensitivity Analysis

### 8.1 Internal Validation

#### 8.1.1 Face Validity
*[Assessment of model behavior and outputs]*

#### 8.1.2 Verification Tests
*[Technical verification of implementation]*

### 8.2 External Validation

#### 8.2.1 Historical Validation
*[Comparison with historical trends]*

#### 8.2.2 Cross-Validation
*[Validation against external data sources]*

### 8.3 Sensitivity Analysis

#### 8.3.1 Parameter Sensitivity
*[Sensitivity to key parameter values]*

#### 8.3.2 Structural Sensitivity
*[Sensitivity to model structure assumptions]*

## 9. Limitations and Assumptions

### 9.1 Model Limitations

#### 9.1.1 Scope Limitations
*[Diseases and risk factors not included]*

#### 9.1.2 Data Limitations
*[Limitations of input data sources]*

#### 9.1.3 Methodological Limitations
*[Limitations of modeling approach]*

### 9.2 Key Assumptions

#### 9.2.1 Risk Factor Assumptions
*[Key assumptions about risk factor modeling]*

#### 9.2.2 Disease Model Assumptions
*[Key assumptions about disease modeling]*

#### 9.2.3 Intervention Assumptions
*[Assumptions about policy interventions]*

## 10. Future Developments

### 10.1 Model Extensions

#### 10.1.1 Additional Diseases
*[Plans for including additional diseases]*

#### 10.1.2 Additional Risk Factors
*[Plans for additional risk factor modeling]*

### 10.2 Methodological Improvements

#### 10.2.1 Statistical Methods
*[Potential improvements to statistical methods]*

#### 10.2.2 Computational Efficiency
*[Plans for improving computational performance]*

## References

*[Complete reference list for technical documentation]*

---

## Appendices

### Appendix A: Mathematical Notation
*[Definition of mathematical symbols and notation]*

### Appendix B: Parameter Tables
*[Complete parameter tables]*

### Appendix C: Validation Results
*[Detailed validation results and figures]*

### Appendix D: Software Dependencies
*[Complete list of software dependencies and versions]*

---

*This technical appendix is based on the supplementary material published with Kypridemos et al. (2025). For the most current version, please refer to the original publication.*
